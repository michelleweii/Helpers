from functools import cmp_to_key
def cmp_center(x,y):
    return x[2][1]-y[2][1]
def cmp_x(x,y):
    return x[2][0]-y[2][0]
def cmp_y(x,y):
    return x[2][1]-y[2][1]
# input: gt_rects [[[76, 563], [291, 602]], [[75, 4], [275, 47]],
# [[974, 780], [1158, 820]], [[973, 506], [1157, 551]],
# [[76, 508], [267, 554]], [[74, 1058], [267, 1104]], [[973, 566], [1188, 607]], [[974, 62],
# [1165, 108]], [[974, 625], [1164, 669]], [[973, 1065], [1158, 1102]],
# [[76, 345], [282, 391]], [[972, 842], [1172, 882]], [[77, 789], [260, 832]], [[76, 65], [260, 104]], [[76, 623], [282, 660]], [[73, 840], [264, 882]], [[974, 679], [1158, 720]], [[75, 291], [260, 325]], [[974, 119], [1164, 161]], [[973, 399], [1165, 436]], [[76, 958], [267, 1001]], [[75, 1009], [260, 1052]], [[76, 681], [268, 720]], [[525, 341], [709, 387]], [[75, 892], [259, 942]], [[973, 953], [1165, 992]], [[974, 171], [1166, 210]], [[75, 454], [260, 492]], [[76, 231], [260, 271]], [[525, 404], [716, 455]], [[76, 182], [260, 219]], [[524, 572], [716, 618]], [[973, 730], [1188, 773]], [[526, 781], [709, 824]], [[525, 1070], [709, 1111]], [[76, 402], [267, 443]], [[524, 6], [709, 44]], [[526, 288], [732, 327]], [[77, 125], [260, 164]], [[524, 844], [709, 887]], [[973, 452], [1157, 489]], [[973, 232], [1158, 276]], [[76, 730], [260, 774]], [[524, 64], [709, 102]], [[524, 901], [709, 945]], [[524, 1007], [723, 1053]], [[525, 181], [709, 221]], [[525, 710], [708, 768]], [[525, 450], [731, 494]], [[525, 515], [724, 561]], [[525, 959], [709, 996]], [[525, 680], [708, 739]], [[526, 612], [731, 657]], [[974, 290], [1188, 326]], [[526, 232], [740, 268]], [[973, 7], [1158, 49]], [[973, 1008], [1157, 1053]], [[973, 344], [1165, 384]], [[526, 121], [709, 155]], [[975, 895], [1238, 941]]]
def sort_rect(lista):
    maxheight = 0
    for item in lista:
        y = (item[1][1]+item[0][1])//2
        x = (item[1][0]+item[0][0])//2
        height = item[1][1]-item[0][1]
        maxheight = max(maxheight,height)
        item.append([x,y])
    lista.sort(key=cmp_to_key(cmp_center))
    row = []
    for i in range(len(lista)//3):
        row.append(lista[i * 3: 3 * (i + 1)])
    for i in row:
        i.sort(key=cmp_to_key(cmp_x))
    #for i in row:
    #    i.sort(key=cmp_to_key(cmp_y))
    new_rect = []
    for i in row:
        for j in i:
            new_rect.append(j[:2])
    return new_rect

if __name__ == '__main__':
    predlist = [[[619, 51], [1204, 221]], [[619, 880], [1170, 1037]], [[0, 871], [550, 1045]], [[0, 1276], [516, 1451]], [[0, 453], [1239, 635]], [[0, 50], [516, 230]]]
    testlist = [[[76, 563], [291, 602]], [[75, 4], [275, 47]], [[974, 780], [1158, 820]], [[973, 506], [1157, 551]]]
    print(sort_rect(testlist))
    print(sort_rect(predlist))
# [[76, 508], [267, 554]], [[74, 1058], [267, 1104]], [[973, 566], [1188, 607]], [[974, 62],
# [1165, 108]], [[974, 625], [1164, 669]], [[973, 1065], [1158, 1102]],